<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
	<title>Ext Web PPT - Frontend-CN - localhost</title>

	<!-- START ExtJS v3.2.1 -->
	<link rel="stylesheet" type="text/css" href="../../../../Ext-JS-v3.2.1/resources/css/ext-all.css" />
	<link rel="stylesheet" type="text/css" href="../../../../Ext-UI-Theme/themes/azenis-theme/resources/css/xtheme-azenis.css" />
	<script type="text/javascript" src="../../../../Ext-JS-v3.2.1/adapter/ext/ext-base.js"></script>
	<script type="text/javascript" src="../../../../Ext-JS-v3.2.1/ext-all.js"></script>
	<!-- END ExtJS v3.2.1 -->

	<!-- START Ext Web PPT -->
	<link type="text/css" rel="stylesheet" href="../../../examples/MessageSlider/styles/MessageSlider.css" />
	<link rel="stylesheet" type="text/css" href="styles/ext-web-ppt.css" />
	<style type="text/css">
		.top-title-cn { font-family: 微软雅黑,Arial,sans-serif; }
	</style>
	<script type="text/javascript" src="scripts/TreeOutliner.js"></script>
	<script type="text/javascript" src="scripts/WebPPT.js"></script>
	<script type="text/javascript" src="../../../examples/MessageSlider/scripts/MessageSlider.js"></script>

	<script type="text/javascript">
		Ext.onReady(function() {            
			new App.WebPPT({
				title: '<a href="#" class="top-title top-title-cn">前端开发 Web 版 PPT</a>',
				dataUrl: 'slides/frontend-cn/slide-data.json',
                callback: function() {
                    var ms = new Ext.ux.MessageSlider({
                        renderTo : 'msg-slider-section',
                        intervalTime : 5,
                        items : App.arrItems
                    });

                    ms.on('change', function(obj, index) {
                        var content = Ext.getCmp('content'),
							tp = Ext.getCmp('moduleTree'),
							nodeItem = App.arrItems[index],
							nodeId = nodeItem.id,
							nodePath = tp.getNodeById(nodeId).getPath(),
                            slidePath = App.rootFolder + '/' + nodeItem.filename;

                        content.load({
							url: slidePath,
							scripts: true
						});
						tp.selectPath(nodePath);
                    });
                }
			});
		});
	</script>
	<!-- END Ext Web PPT -->

  </head>
  <body>

    <div id="msg-slider-section"></div>

  </body>
</html>